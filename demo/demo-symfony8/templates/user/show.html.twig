{% extends 'base.html.twig' %}

{% block title %}User #{{ user.id }} - {{ connection|upper }}{% endblock %}

{% block body %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>User Details <span class="connection-badge {{ connection }}">{{ connection }}</span></h2>
        <div>
            <a href="{{ path('user_edit', {connection: connection, id: user.id}) }}" class="btn btn-primary">Edit</a>
            <a href="{{ path('user_index', {connection: connection}) }}" class="btn btn-secondary">Back to List</a>
        </div>
    </div>

    <table>
        <tr>
            <th>ID</th>
            <td>{{ user.id }}</td>
        </tr>
        <tr>
            <th>Email</th>
            <td>{{ user.email }}</td>
        </tr>
        <tr>
            <th>First Name</th>
            <td>{{ user.firstName }}</td>
        </tr>
        <tr>
            <th>Last Name</th>
            <td>{{ user.lastName }}</td>
        </tr>
        <tr>
            <th>Age</th>
            <td>{{ user.age }}</td>
        </tr>
        <tr>
            <th>Phone</th>
            <td>{{ user.phone ?? '-' }}</td>
        </tr>
        <tr>
            <th>IBAN</th>
            <td>{{ user.iban ?? '-' }}</td>
        </tr>
        <tr>
            <th>Credit Card</th>
            <td>{{ user.creditCard ?? '-' }}</td>
        </tr>
        <tr>
            <th>Status</th>
            <td>{{ user.status }}</td>
        </tr>
        {% if hasAnonymizedColumn|default(false) %}
        <tr>
            <th>Anonymized</th>
            <td>
                {% if user.isAnonymized() %}
                    <span style="color: #28a745; font-weight: bold;">✓ Yes</span>
                {% else %}
                    <span style="color: #6c757d;">✗ No</span>
                {% endif %}
            </td>
        </tr>
        {% endif %}
    </table>
    {% if not hasAnonymizedColumn|default(false) %}
    <div class="alert alert-warning" style="background: #fff3cd; border: 1px solid #ffc107; color: #856404; padding: 15px; border-radius: 5px; margin-top: 20px;">
        <strong>⚠️ Columna "anonymized" no encontrada</strong><br>
        Para añadir la columna de seguimiento de anonimización, ejecuta:<br>
        <code style="background: #f8f9fa; padding: 5px 10px; border-radius: 3px; display: inline-block; margin-top: 10px;">
            php bin/console nowo:anonymize:generate-column-migration --connection {{ connection }}
        </code>
    </div>
    {% endif %}
</div>
{% endblock %}
